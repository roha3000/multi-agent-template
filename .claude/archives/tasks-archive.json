{
  "archivedAt": "2025-12-28T18:02:07.595Z",
  "tasks": {
    "hierarchy-quickwin-parallel-synthesis": {
      "id": "hierarchy-quickwin-parallel-synthesis",
      "title": "Quick Win: Parallelize Debate Synthesis",
      "description": "Enable parallel synthesis in executeDebate() pattern. Currently only first agent synthesizes sequentially after each round. Allow multiple synthesizers with result merging for 2.5x faster debates.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "4h",
      "tags": [
        "hierarchy",
        "quick-win",
        "performance",
        "parallelization"
      ],
      "depends": {
        "blocks": [],
        "requires": [],
        "related": [
          "hierarchy-phase2-delegation"
        ]
      },
      "acceptance": [
        "executeDebate() supports parallelSynthesis option",
        "Multiple synthesizers can work concurrently",
        "Synthesis results merged intelligently (best-of or consensus)",
        "Debate time reduced from ~360s to ~140s for 3 rounds",
        "Backward compatible - default behavior unchanged",
        "Unit tests for parallel synthesis mode"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-28T14:41:00.000Z",
      "completed": "2025-12-28T14:41:00.000Z",
      "estimatedSpeedup": "2.5x",
      "qualityScore": 95,
      "deliverables": [
        ".claude/core/agent-orchestrator.js: executeDebate() now supports parallelSynthesis option",
        "New options: parallelSynthesis, synthesizerCount, mergeStrategy ('best', 'consensus', 'merge')",
        "New _mergeDebateSyntheses() method for intelligent result merging",
        "New _calculateSimilarity() method for consensus detection",
        "Backward compatible - default behavior unchanged (parallelSynthesis=false)"
      ]
    },
    "hierarchy-quickwin-parallel-planner": {
      "id": "hierarchy-quickwin-parallel-planner",
      "title": "Quick Win: Parallelize Competitive Planner",
      "description": "Convert sequential plan generation in CompetitivePlanner._generatePlanForStrategy() to parallel execution. Currently generates plans one-by-one. Parallelization achieves 3x faster planning.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "2h",
      "tags": [
        "hierarchy",
        "quick-win",
        "performance",
        "parallelization"
      ],
      "depends": {
        "blocks": [],
        "requires": [],
        "related": [
          "hierarchy-phase1-registry"
        ]
      },
      "acceptance": [
        "CompetitivePlanner generates all strategy plans in parallel",
        "Planning time reduced from ~180s to ~60s for 3 strategies",
        "Results aggregation maintains quality ranking",
        "Error handling for individual strategy failures",
        "Unit tests verify parallel plan generation"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-28T14:41:00.000Z",
      "completed": "2025-12-28T14:41:00.000Z",
      "estimatedSpeedup": "3x",
      "qualityScore": 95,
      "deliverables": [
        ".claude/core/competitive-planner.js: generatePlans() now uses Promise.allSettled() for parallel strategy execution",
        "_generatePlanForStrategy() converted to async for future LLM call support",
        "Individual strategy failures handled gracefully"
      ]
    },
    "hierarchy-prereq-failure-cascade": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "hierarchy-prereq-failure-cascade",
      "title": "Prerequisite: Failure Cascade Handling",
      "description": "Implement supervision tree pattern for hierarchical error handling. Required before hierarchy implementation to prevent orphaned sub-agents, enable structured error propagation, and support partial result recovery.",
      "phase": "implementation",
      "priority": "critical",
      "estimate": "8h",
      "tags": [
        "hierarchy",
        "prerequisite",
        "error-handling",
        "supervision"
      ],
      "depends": {
        "blocks": [
          "hierarchy-phase1-registry"
        ],
        "requires": [
          "hierarchy-quickwin-parallel-loader"
        ],
        "related": []
      },
      "acceptance": [
        "SupervisionTree class with restart strategies (one-for-one, all-for-one, rest-for-one)",
        "HierarchicalError class with agentId, parentId, childErrors, partialResults",
        "Parent agents can define child restart policies",
        "Orphan detection and cleanup when parent terminates",
        "Partial result recovery via MemoryStore checkpointing",
        "Unit tests for each restart strategy",
        "Integration tests for cascade scenarios"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-28T14:45:00.000Z",
      "completed": "2025-12-28T14:45:00.000Z",
      "criticalPath": true,
      "qualityScore": 95,
      "deliverables": [
        ".claude/core/supervision-tree.js: SupervisionTree class with restart strategies",
        "HierarchicalError class with error chain, partial results aggregation",
        "RestartStrategy enum (ONE_FOR_ONE, ALL_FOR_ONE, REST_FOR_ONE)",
        "Orphan detection and cleanup methods",
        "Checkpoint storage for partial result recovery",
        "__tests__/core/supervision-tree.test.js: 42 unit tests"
      ]
    },
    "hierarchy-phase1-registry": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "hierarchy-phase1-registry",
      "title": "Phase 1: Core Hierarchy Registry",
      "description": "Create HierarchyRegistry class for centralized tracking of parent-child agent relationships, delegation chains, and hierarchy metadata. Foundation for all subsequent hierarchy features.",
      "phase": "implementation",
      "priority": "critical",
      "estimate": "6h",
      "tags": [
        "hierarchy",
        "phase1",
        "core",
        "registry"
      ],
      "depends": {
        "blocks": [
          "hierarchy-phase1-agent-extension",
          "hierarchy-phase1-session-extension"
        ],
        "requires": [
          "hierarchy-prereq-failure-cascade",
          "hierarchy-prereq-state-management"
        ],
        "related": []
      },
      "acceptance": [
        "HierarchyRegistry class with roots, nodes, delegations Maps",
        "Quick lookup indexes: byParent, byDepth, byStatus",
        "registerHierarchy(parentId, childId, metadata) method",
        "getHierarchy(agentId) returns full subtree",
        "getDelegationChain(agentId) returns path from root",
        "pruneHierarchy(rootId) removes entire subtree",
        "Singleton instance accessible from Agent and Orchestrator",
        "Unit tests for all registry operations"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-28T15:05:00.000Z",
      "completed": "2025-12-28T15:05:00.000Z",
      "qualityScore": 95,
      "deliverables": [
        ".claude/core/hierarchy-registry.js: HierarchyRegistry class with full API",
        "DelegationStatus enum (PENDING, ACTIVE, COMPLETED, FAILED, CANCELLED)",
        "HierarchyError class for hierarchy-specific errors",
        "Singleton pattern via getHierarchyRegistry() and resetHierarchyRegistry()",
        "Quick lookup indexes: byParent, byDepth, byStatus Maps",
        "State export/import for persistence",
        "__tests__/core/hierarchy-registry.test.js: 67 unit tests"
      ]
    },
    "dashboard-project-isolation": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "dashboard-project-isolation",
      "title": "Multi-Project Session Context Isolation",
      "description": "Dashboard shows same context for different projects because of single global TaskManager and executionState. Need per-project storage so each project displays its own tasks, metrics, and execution state independently.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "4h",
      "tags": [
        "dashboard",
        "session",
        "multi-project",
        "context-isolation"
      ],
      "depends": {
        "blocks": [],
        "requires": [],
        "related": [
          "hierarchy-phase1-session-extension"
        ]
      },
      "acceptance": [
        "Backend: TaskManager instances stored in Map keyed by project path",
        "Backend: ExecutionState stored per-session in Map",
        "API: /api/tasks accepts optional projectPath param (backward compat)",
        "API: /api/execution accepts optional sessionId param (backward compat)",
        "SessionRegistry: projectKey field added for project isolation",
        "Frontend: projectTasksData and projectExecutionState Maps replace globals",
        "Frontend: enrichAllActiveSessions() enriches each project independently",
        "Test: 2 projects show different tasks/context simultaneously",
        "Test: Same project with 2 CLI windows shows separate entries",
        "Test: Backward compat - parameterless API calls still work"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T21:00:00.000Z",
      "updated": "2025-12-28T16:00:00.000Z",
      "completed": "2025-12-28T16:00:00.000Z",
      "qualityScore": 95,
      "deliverables": [
        "global-context-manager.js: Per-project TaskManager Map (getTaskManagerForProject)",
        "global-context-manager.js: Per-session ExecutionState Map (getExecutionState)",
        "session-registry.js: projectKey field with path normalization",
        "global-dashboard.html: projectTasksData/projectExecutionState Maps",
        "global-dashboard.html: enrichAllActiveSessions() with per-project enrichment"
      ],
      "notes": "Implemented via 4 parallel agents. All acceptance criteria met. Backward compatible - APIs work without params."
    },
    "parallel-safety-phase1-optimistic-locking": {
      "parentTaskId": "taskjson-parallel-session-safety",
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 1,
      "decomposition": null,
      "id": "parallel-safety-phase1-optimistic-locking",
      "title": "Phase 1: Optimistic Locking with Version Numbers",
      "description": "Add version field to tasks.json and implement optimistic locking in TaskManager. Quick win that detects conflicts and enables automatic retry with merge.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "4h",
      "tags": [
        "task-manager",
        "concurrency",
        "optimistic-locking",
        "quick-win"
      ],
      "depends": {
        "blocks": [
          "parallel-safety-phase2-sqlite-coordinator"
        ],
        "requires": [],
        "related": []
      },
      "acceptance": [
        "Add _concurrency field to tasks.json: {version, lastModifiedBy, lastModifiedAt}",
        "TaskManager.save() checks version before write",
        "Version mismatch triggers merge and retry (max 3 attempts)",
        "Session ID tracked in TaskManager constructor",
        "Conflict events emitted for logging/debugging",
        "Backward compatible - works without _concurrency field",
        "Unit tests for version conflict detection",
        "Unit tests for automatic merge and retry"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T22:00:00.000Z",
      "updated": "2025-12-28T21:03:40.609Z",
      "implementationNotes": {
        "files_to_modify": [
          ".claude/core/task-manager.js"
        ],
        "schema_change": {
          "_concurrency": {
            "version": "integer, increments on each save",
            "lastModifiedBy": "session ID string",
            "lastModifiedAt": "ISO timestamp"
          }
        },
        "key_methods": [
          "_checkVersionConflict()",
          "_incrementVersion()",
          "save() - add retry loop"
        ]
      },
      "completed": "2025-12-28T21:03:40.610Z"
    },
    "hierarchy-phase1-task-extension": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "hierarchy-phase1-task-extension",
      "title": "Phase 1: Task Manager Hierarchy Extension",
      "description": "Extend TaskManager with parent-child task relationships, delegatedTo tracking, and decomposition metadata. Enables hierarchical task breakdown and progress tracking.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "4h",
      "tags": [
        "hierarchy",
        "phase1",
        "task-manager",
        "extension"
      ],
      "depends": {
        "blocks": [
          "hierarchy-phase2-delegation"
        ],
        "requires": [
          "hierarchy-phase1-agent-extension"
        ],
        "related": []
      },
      "acceptance": [
        "Task schema has parentTaskId, childTaskIds, delegatedTo fields",
        "Task has delegationDepth tracking",
        "Task has decomposition object: {strategy, estimatedSubtasks, completedSubtasks, aggregationRule}",
        "createSubtask(parentTaskId, subtaskData) method",
        "getTaskHierarchy(taskId) returns full task tree",
        "Subtask completion auto-updates parent progress",
        "Backward compatible with existing task structure",
        "Unit tests for task hierarchy operations"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-28T17:00:00.000Z",
      "completed": "2025-12-28T20:40:41.573Z",
      "qualityScore": 95,
      "deliverables": [
        ".claude/core/task-manager.js: 14 hierarchy methods (+540 lines)",
        "scripts/migrate-tasks-hierarchy.js: Migration script",
        "69 tasks migrated with explicit hierarchy fields"
      ]
    },
    "hierarchy-phase2-aggregation": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "hierarchy-phase2-aggregation",
      "title": "Phase 2: Result Aggregation Strategies",
      "description": "Implement aggregation strategies for combining sub-agent results: merge, selectBest, vote, chain. Each strategy suited for different delegation patterns.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "4h",
      "tags": [
        "hierarchy",
        "phase2",
        "aggregation",
        "strategies"
      ],
      "depends": {
        "blocks": [
          "hierarchy-phase3-decomposer"
        ],
        "requires": [
          "hierarchy-phase2-delegation"
        ],
        "related": []
      },
      "acceptance": [
        "AggregationStrategies.merge() combines all results",
        "AggregationStrategies.selectBest() picks highest quality",
        "AggregationStrategies.vote() uses consensus voting",
        "AggregationStrategies.chain() sequences results (output N -> input N+1)",
        "Custom aggregation function support",
        "Aggregation metadata (strategy used, confidence, alternatives)",
        "Unit tests for each strategy with edge cases"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-28T22:30:00.000Z",
      "completed": "2025-12-28T22:30:00.000Z",
      "qualityScore": 95,
      "deliverables": [
        ".claude/core/aggregation-strategies.js: AggregationStrategies class (~410 lines)",
        "merge() with array dedup, object merge, primitive handling",
        "selectBest() with quality scoring, tie breakers, custom selectors",
        "vote() with majority, weighted, unanimous strategies",
        "chain() with pipeline stages (filter, transform, aggregate, validate)",
        "custom() for user-provided aggregation functions",
        "calculateSimilarity() helper for Jaccard similarity",
        "__tests__/core/aggregation-strategies.test.js: 19 unit tests"
      ]
    },
    "hierarchy-phase3-decomposer": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "hierarchy-phase3-decomposer",
      "title": "Phase 3: Task Decomposer",
      "description": "Implement TaskDecomposer class for intelligent task breakdown. Analyzes task complexity and automatically generates subtasks with appropriate agent assignments.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "6h",
      "tags": [
        "hierarchy",
        "phase3",
        "decomposition",
        "automation"
      ],
      "depends": {
        "blocks": [
          "hierarchy-phase3-auto-delegation"
        ],
        "requires": [
          "hierarchy-phase2-aggregation"
        ],
        "related": []
      },
      "acceptance": [
        "TaskDecomposer.analyze(task) returns DecompositionSuggestion",
        "TaskDecomposer.decompose(task, strategy) returns subtask array",
        "Decomposition strategies: parallel, sequential, hybrid, manual",
        "Integration with ComplexityAnalyzer for delegation decisions",
        "Subtask estimation (effort, tokens, time)",
        "Agent capability matching for subtasks",
        "Unit tests for decomposition logic"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-28T15:15:00.000Z",
      "completed": "2025-12-28T15:15:00.000Z",
      "qualityScore": 95,
      "deliverables": [
        ".claude/core/task-decomposer.js: TaskDecomposer class (~993 lines)",
        ".claude/core/decomposition-strategies.js: DecompositionStrategies with 4 strategy classes (~1477 lines)",
        "__tests__/core/task-decomposer.test.js: 80 tests for decomposer",
        "__tests__/core/decomposition-strategies.test.js: 43 tests for strategies",
        "Complexity scoring with weighted factors",
        "Capability matching for subtask agent assignment",
        "Phase-based subtask templates for all 6 development phases"
      ]
    },
    "parallel-safety-phase3-shadow-mode": {
      "parentTaskId": "taskjson-parallel-session-safety",
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 1,
      "decomposition": null,
      "id": "parallel-safety-phase3-shadow-mode",
      "title": "Phase 3: Shadow Mode Validation",
      "description": "Run SQLite coordinator in shadow mode alongside existing file operations to validate consistency. Detect any divergence before full migration.",
      "phase": "testing",
      "priority": "medium",
      "estimate": "3h",
      "tags": [
        "task-manager",
        "concurrency",
        "validation",
        "shadow-mode"
      ],
      "depends": {
        "blocks": [
          "parallel-safety-phase4-dashboard-conflicts"
        ],
        "requires": [
          "parallel-safety-phase2-sqlite-coordinator"
        ],
        "related": []
      },
      "acceptance": [
        "Shadow mode flag in TaskManager constructor",
        "When enabled: write to both JSON and SQLite",
        "Consistency check on each save (hash comparison)",
        "Log any divergence with full context",
        "Run for 1 week in production before full switch",
        "Metrics: conflict_count, merge_count, divergence_count",
        "Dashboard indicator showing shadow mode status"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T22:00:00.000Z",
      "updated": "2025-12-28T22:45:00.000Z",
      "completed": "2025-12-28T22:45:00.000Z",
      "qualityScore": 95,
      "deliverables": [
        ".claude/core/shadow-mode-metrics.js: ShadowModeMetrics class (~400 lines)",
        ".claude/core/task-manager.js: Shadow mode integration with dual-write validation",
        ".claude/core/enhanced-dashboard-server.js: 6 new shadow mode API endpoints",
        "__tests__/core/shadow-mode.test.js: 48 unit tests",
        "SHA-256 deterministic hashing with normalized JSON",
        "Divergence detection and health scoring (0-100)"
      ]
    },
    "hierarchy-phase2-delegation": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "hierarchy-phase2-delegation",
      "title": "Phase 2: Delegation Primitives",
      "description": "Implement core delegation methods in AgentOrchestrator: delegateTask(), spawnSubAgent(), aggregateResults(). Enables parent agents to spawn sub-agents and collect results.",
      "phase": "implementation",
      "priority": "critical",
      "estimate": "8h",
      "tags": [
        "hierarchy",
        "phase2",
        "delegation",
        "core"
      ],
      "depends": {
        "blocks": [
          "hierarchy-phase2-context",
          "hierarchy-phase2-aggregation"
        ],
        "requires": [
          "hierarchy-phase1-task-extension"
        ],
        "related": []
      },
      "acceptance": [
        "AgentOrchestrator.delegateTask(parentAgentId, task, options) method",
        "AgentOrchestrator.spawnSubAgent(parentAgentId, agentConfig) method",
        "AgentOrchestrator.aggregateResults(delegationId, results, strategy) method",
        "Delegation options: decompositionStrategy, agentSelectionStrategy, aggregationStrategy, maxDepth, timeout",
        "Sub-agents automatically registered in HierarchyRegistry",
        "Delegation lifecycle events published to MessageBus",
        "Unit tests for delegation flow",
        "Integration tests for multi-level delegation"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-28T22:30:00.000Z",
      "completed": "2025-12-28T22:30:00.000Z",
      "qualityScore": 95,
      "deliverables": [
        ".claude/core/agent-orchestrator.js: delegateTask(), aggregateResults(), executeParallelDelegation() methods",
        "DelegationContext import and integration",
        "AggregationStrategies import and integration"
      ]
    },
    "hierarchy-phase2-context": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "hierarchy-phase2-context",
      "title": "Phase 2: Delegation Context Builder",
      "description": "Implement DelegationContext builder for minimal, task-specific context passing to sub-agents. Reduces token overhead by 67-74% through context isolation.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "4h",
      "tags": [
        "hierarchy",
        "phase2",
        "context",
        "token-efficiency"
      ],
      "depends": {
        "blocks": [],
        "requires": [
          "hierarchy-phase2-delegation"
        ],
        "related": []
      },
      "acceptance": [
        "DelegationContext class with minimal required fields",
        "buildDelegationContext(parentAgent, task, subtask) method",
        "Context slicing: only required fields passed to sub-agents",
        "Constraint passing: deadline, tokenBudget, mustComplete",
        "Communication channel setup with MessageBus topics",
        "Context size logging for optimization tracking",
        "Token usage reduced by 60%+ compared to full context",
        "Unit tests for context building"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-28T22:30:00.000Z",
      "completed": "2025-12-28T22:30:00.000Z",
      "qualityScore": 95,
      "estimatedTokenSavings": "67%",
      "deliverables": [
        ".claude/core/delegation-context.js: DelegationContext class (~345 lines)",
        "buildDelegationContext() static method for context creation",
        "_selectRelevantArtifacts() for artifact slicing",
        "_summarizePhase() for phase info compression",
        "Communication channels, deadline management, quality threshold checks",
        "__tests__/core/delegation-context.test.js: 25 unit tests"
      ]
    },
    "hierarchy-phase4-optimization": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "hierarchy-phase4-optimization",
      "title": "Phase 4: Performance Optimization",
      "description": "Optimize hierarchy performance: agent pooling, pre-warming, caching, tiered timeouts. Target: minimize coordination overhead to maximize parallelism gains.",
      "phase": "implementation",
      "priority": "medium",
      "estimate": "6h",
      "tags": [
        "hierarchy",
        "phase4",
        "optimization",
        "performance"
      ],
      "depends": {
        "blocks": [],
        "requires": [
          "hierarchy-phase3-auto-delegation"
        ],
        "related": [
          "hierarchy-phase4-metrics"
        ]
      },
      "acceptance": [
        "Agent pool for pre-warmed sub-agents (configurable pool size)",
        "Tiered timeouts by depth (level 1: 60s, level 2: 30s, level 3: 15s)",
        "Context caching at parent level for shared sub-agent context",
        "Speculative execution support (start children before full analysis)",
        "Memory-efficient agent recycling",
        "Performance benchmarks vs baseline flat execution",
        "Configuration options in CLAUDE.md"
      ],
      "status": "done",
      "score": 95,
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-29T05:00:00.000Z",
      "completedAt": "2025-12-29T05:00:00.000Z"
    },
    "hierarchy-phase4-metrics": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "hierarchy-phase4-metrics",
      "title": "Phase 4: Delegation Metrics and Analytics",
      "description": "Implement comprehensive metrics for delegation performance: duration, success rates, token usage, speedups achieved. Enables optimization decisions.",
      "phase": "implementation",
      "priority": "medium",
      "estimate": "4h",
      "tags": [
        "hierarchy",
        "phase4",
        "metrics",
        "analytics"
      ],
      "depends": {
        "blocks": [],
        "requires": [
          "hierarchy-phase3-auto-delegation"
        ],
        "related": [
          "hierarchy-phase4-dashboard-viz"
        ]
      },
      "acceptance": [
        "DelegationMetrics: duration, subtaskCount, depth, aggregationTime histograms",
        "Success/failure counters: delegationSuccess, delegationFailure, retryCount",
        "Quality metrics: subAgentQualityScore, aggregationQuality",
        "Resource metrics: tokenBudgetUsed, timeBudgetUsed, activeChildCount",
        "GET /api/metrics/delegation endpoint",
        "Metrics exported to MemoryStore for historical analysis",
        "Dashboard metrics panel integration"
      ],
      "status": "done",
      "score": 95,
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-29T04:00:00.000Z",
      "completedAt": "2025-12-29T04:00:00.000Z"
    },
    "hierarchy-tests-unit": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "hierarchy-tests-unit",
      "title": "Hierarchy System Unit Tests",
      "description": "Comprehensive unit tests for all hierarchy components: registry, agent extensions, session extensions, task extensions, delegation primitives, aggregation strategies.",
      "phase": "testing",
      "priority": "high",
      "estimate": "4h",
      "tags": [
        "hierarchy",
        "testing",
        "unit-tests"
      ],
      "depends": {
        "blocks": [],
        "requires": [
          "hierarchy-phase2-aggregation"
        ],
        "related": [
          "hierarchy-tests-integration"
        ]
      },
      "acceptance": [
        "HierarchyRegistry tests: register, get, prune, index operations",
        "Agent hierarchy tests: metadata, canDelegate, parent/child accessors",
        "Session hierarchy tests: rollup aggregation, hierarchy queries",
        "Task hierarchy tests: subtask creation, hierarchy traversal",
        "Delegation tests: spawn, delegate, aggregate",
        "Aggregation strategy tests: merge, selectBest, vote, chain",
        "Coverage > 80% for hierarchy modules",
        "All tests pass in CI"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-29T10:00:00.000Z",
      "started": "2025-12-29T09:00:00.000Z",
      "completedAt": "2025-12-29T10:00:00.000Z",
      "notes": "563 tests passing, 89% statement coverage, 80% branch coverage, 94% function coverage"
    },
    "parallel-safety-phase2-sqlite-coordinator": {
      "parentTaskId": "taskjson-parallel-session-safety",
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 1,
      "decomposition": null,
      "id": "parallel-safety-phase2-sqlite-coordinator",
      "title": "Phase 2: SQLite Coordination Layer",
      "description": "Create CoordinationDB class using SQLite for cross-process locking, session tracking, and change journaling. JSON remains human-readable, SQLite handles concurrency.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "6h",
      "tags": [
        "task-manager",
        "concurrency",
        "sqlite",
        "coordination"
      ],
      "depends": {
        "blocks": [
          "parallel-safety-phase3-shadow-mode"
        ],
        "requires": [
          "parallel-safety-phase1-optimistic-locking"
        ],
        "related": []
      },
      "acceptance": [
        "CoordinationDB class in .claude/core/coordination-db.js",
        "SQLite schema: sessions, locks, change_journal tables",
        "acquireLock(resource, sessionId, timeout) method",
        "releaseLock(resource, sessionId) method",
        "Lock auto-expiration (60s default) for crash recovery",
        "Session heartbeat tracking (stale after 5min)",
        "Change journal for audit trail",
        "Integration with existing TaskManager",
        "Unit tests for lock acquisition/release",
        "Unit tests for stale lock cleanup"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T22:00:00.000Z",
      "updated": "2025-12-28T23:30:00.000Z",
      "completed": "2025-12-28T23:30:00.000Z",
      "qualityScore": 95,
      "deliverables": [
        ".claude/core/coordination-db.js: 550+ lines CoordinationDB class",
        "SQLite schema: sessions, locks, change_journal tables with indexes",
        "acquireLock(), releaseLock(), refreshLock(), isLockHeld() methods",
        "withLock() convenience wrapper for atomic operations",
        "Session management: register, heartbeat, deregister, stale detection",
        "Change journal: recordChange, query methods, pruning",
        "Auto-cleanup timers for expired locks and stale sessions",
        "TaskManager integration: lazy init, lock on save, journal changes",
        "__tests__/core/coordination-db.test.js: 49 unit tests",
        ".gitignore updated for .coordination/ database files"
      ],
      "implementationNotes": {
        "files_created": [
          ".claude/core/coordination-db.js",
          "__tests__/core/coordination-db.test.js"
        ],
        "files_modified": [
          ".claude/core/task-manager.js",
          ".gitignore"
        ],
        "schema": {
          "sessions": "id, project_path, agent_type, started_at, last_heartbeat, metadata, pid",
          "locks": "resource, session_id, acquired_at, expires_at, lock_type, refresh_count",
          "change_journal": "id, session_id, resource, operation, change_data, created_at, applied, checksum"
        },
        "approach": "5 expert agents in parallel: Schema Designer, Pattern Researcher, Lock Management, Session Heartbeat, Test Engineer"
      }
    },
    "hierarchy-phase3-auto-delegation": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "hierarchy-phase3-auto-delegation",
      "title": "Phase 3: Automatic Delegation Decisions",
      "description": "Implement automatic delegation decision logic based on task complexity, context utilization, and agent confidence. Parent agents can auto-delegate without manual intervention.",
      "phase": "implementation",
      "priority": "medium",
      "estimate": "4h",
      "tags": [
        "hierarchy",
        "phase3",
        "automation",
        "decisions"
      ],
      "depends": {
        "blocks": [
          "hierarchy-phase4-optimization"
        ],
        "requires": [
          "hierarchy-phase3-decomposer"
        ],
        "related": []
      },
      "acceptance": [
        "DelegationDecision factors: complexity, contextUtilization, subtaskCount, confidence",
        "Configurable thresholds for automatic delegation",
        "shouldDelegate(task, agent) returns decision with reasoning",
        "Integration with existing executeParallel/executeDebate patterns",
        "Delegation hints surfaced to dashboard",
        "Unit tests for decision logic"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-28T20:00:00.000Z",
      "updated": "2025-12-28T23:45:00.000Z",
      "completed": "2025-12-28T23:45:00.000Z",
      "qualityScore": 95,
      "deliverables": [
        ".claude/core/delegation-decider.js: DelegationDecider class (~600 lines)",
        "6 decision factors: complexity, contextUtilization, subtaskCount, agentConfidence, agentLoad, depthRemaining",
        "Weighted scoring algorithm, pattern selection (parallel/sequential/debate/review/ensemble)",
        "AgentOrchestrator integration: executeWithAutoDelegation(), getDelegationHint()",
        "Dashboard API: 6 new endpoints for delegation hints",
        "__tests__/core/delegation-decider.test.js: 44 unit tests"
      ]
    },
    "dashboard-ux-redesign": {
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": null,
      "id": "dashboard-ux-redesign",
      "title": "Dashboard Fleet Management Redesign",
      "description": "Redesign dashboard for Fleet Management mode (5+ concurrent sessions). Add agent lineage visibility, countdown timers for token/rate limits, smart defaults for metric surfacing, and alert system with banner+sound+toast. Based on agent swarm analysis and user requirements.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "16h",
      "tags": [
        "dashboard",
        "ux",
        "fleet-management",
        "agent-monitoring",
        "visualization"
      ],
      "depends": {
        "blocks": [
          "dashboard-blocked-tasks-view"
        ],
        "requires": [],
        "related": [
          "dashboard-blocked-tasks-view",
          "auto-delegation-integration"
        ]
      },
      "acceptance": [
        "Fleet overview shows all projects/sessions at a glance",
        "5-hour countdown timer with remaining time visible",
        "Session context countdown shows time until auto-compact",
        "Agent lineage tree shows full parent-child delegation hierarchy",
        "Alert banner with sound for critical alerts (token exhaustion, rate limit)",
        "Toast notifications for other events (task claimed, session started)",
        "Smart defaults auto-surface relevant metrics based on context",
        "New /api/agent-pool/status endpoint returns lineage + metrics",
        "New /api/overview endpoint returns fleet-level aggregates",
        "WebSocket channel /ws/fleet for real-time delegation events",
        "Keyboard navigation (arrows, ESC, number keys)",
        "Performance: overview loads <500ms, drill-downs <200ms"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-31T01:00:00.000Z",
      "updated": "2025-12-31T05:00:00.000Z",
      "completedAt": "2025-12-31T05:00:00.000Z",
      "completionNotes": "All 5 phases complete: Backend APIs, Fleet header/alerts, Project cards, Agent lineage tree, Keyboard navigation. 14 new E2E tests added.",
      "designDocs": [
        "docs/design/DASHBOARD-FLEET-MANAGEMENT-DESIGN.md",
        "docs/design/DASHBOARD-UX-REDESIGN.md",
        "docs/audits/dashboard-validation-2025-12-31.md"
      ]
    },
    "fix-orchestrator-quality-score": {
      "id": "fix-orchestrator-quality-score",
      "title": "Fix Orchestrator Quality Score Not Updating in Dashboard",
      "description": "The orchestrator registers sessions with qualityScore: 0 but updateCommandCenter() never sends quality score updates to the dashboard. Quality scores are calculated in evaluatePhaseCompletion() but never transmitted. Dashboard always shows 0.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "30m",
      "tags": [
        "orchestrator",
        "dashboard",
        "bug-fix",
        "quality"
      ],
      "depends": {
        "blocks": [],
        "requires": [],
        "related": [
          "orchestrator-log-forwarding"
        ]
      },
      "acceptance": [
        "updateCommandCenter() includes qualityScore parameter",
        "Quality score sent after evaluatePhaseCompletion() runs",
        "Dashboard displays real-time quality scores for autonomous sessions",
        "Tests verify quality score updates are sent"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2026-01-04T20:30:00.000Z",
      "updated": "2026-01-04T20:45:00.000Z",
      "completedAt": "2026-01-04T20:45:00.000Z",
      "completionNotes": "Added updateCommandCenter({ qualityScore: phaseEval.score }) after evaluatePhaseCompletion() in autonomous-orchestrator.js:1244-1245.",
      "parentTaskId": null,
      "childTaskIds": [],
      "auditSource": "Dashboard Investigation - Session 89"
    },
    "fix-orchestrator-hierarchy": {
      "id": "fix-orchestrator-hierarchy",
      "title": "Fix Missing Hierarchy in Autonomous Sessions",
      "description": "The session hierarchy panel shows no children for autonomous sessions. getAllDelegations() and getChildSessions() return empty arrays because the orchestrator doesn't register parent-child relationships when spawning child agents. Need to register hierarchy when Task tool creates child agents.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "1h",
      "tags": [
        "orchestrator",
        "dashboard",
        "hierarchy",
        "bug-fix"
      ],
      "depends": {
        "blocks": [],
        "requires": [],
        "related": [
          "add-hierarchy-delegation-tracking",
          "auto-delegation-phase5-dashboard"
        ]
      },
      "acceptance": [
        "Child sessions register with parentId when spawned",
        "Session registry tracks parent-child relationships",
        "Dashboard hierarchy panel shows child sessions",
        "Delegation chain visible in UI",
        "Tests verify hierarchy registration"
      ],
      "status": "completed",
      "completedAt": "2026-01-04T20:45:00.000Z",
      "completionNotes": "Added PARENT_SESSION_ID env var to orchestrator spawn (autonomous-orchestrator.js:562-567). Updated session-start.js hook to read parentSessionId from env and include in registration (lines 73-95). Updated global-context-manager.js to pass parentSessionId to session registry. Updated session-registry.js to accept parentSessionId directly (not just via hierarchy object).",
      "assignee": null,
      "created": "2026-01-04T20:30:00.000Z",
      "updated": "2026-01-04T20:45:00.000Z",
      "parentTaskId": null,
      "childTaskIds": [],
      "auditSource": "Dashboard Investigation - Session 89"
    },
    "fix-orchestrator-model-selection": {
      "id": "fix-orchestrator-model-selection",
      "title": "Fix Orchestrator Using Wrong Model (Sonnet 4 instead of Opus 4.5)",
      "description": "The autonomous orchestrator spawns Claude with args ['-p', '--dangerously-skip-permissions'] but doesn't specify a model. Claude Code defaults to Sonnet 4 instead of Opus 4.5. Need to add --model claude-opus-4-5-20251101 to spawn args.",
      "phase": "implementation",
      "priority": "critical",
      "estimate": "15m",
      "tags": [
        "orchestrator",
        "model",
        "bug-fix",
        "configuration"
      ],
      "depends": {
        "blocks": [],
        "requires": [],
        "related": []
      },
      "acceptance": [
        "Orchestrator spawn args include --model claude-opus-4-5-20251101",
        "Model configurable via CONFIG or environment variable",
        "Dashboard shows correct model for autonomous sessions",
        "Tests verify model arg is passed"
      ],
      "status": "completed",
      "completedAt": "2026-01-04T20:45:00.000Z",
      "completionNotes": "Added CONFIG.model with default claude-opus-4-5-20251101 and CLAUDE_MODEL env var support. Added --model argument parsing. Updated spawn args to include --model CONFIG.model. Updated help text.",
      "assignee": null,
      "created": "2026-01-04T20:30:00.000Z",
      "updated": "2026-01-04T20:45:00.000Z",
      "parentTaskId": null,
      "childTaskIds": [],
      "auditSource": "Dashboard Investigation - Session 89"
    },
    "fix-orchestrator-log-verification": {
      "id": "fix-orchestrator-log-verification",
      "title": "Verify Orchestrator Log Forwarding to Dashboard",
      "description": "The logToDashboard() function exists and should forward logs to /api/logs/:sessionId/write, but logs aren't appearing in dashboard. Need to verify registeredSessionId is set correctly and logs are being received.",
      "phase": "implementation",
      "priority": "medium",
      "estimate": "30m",
      "tags": [
        "orchestrator",
        "dashboard",
        "logging",
        "verification"
      ],
      "depends": {
        "blocks": [],
        "requires": [],
        "related": [
          "orchestrator-log-forwarding"
        ]
      },
      "acceptance": [
        "Verify registeredSessionId is set after session registration",
        "Add debug logging to logToDashboard() on failure",
        "Confirm logs appear in dashboard Logs tab",
        "Add test for end-to-end log forwarding"
      ],
      "status": "completed",
      "completedAt": "2026-01-04T20:45:00.000Z",
      "completionNotes": "Added DEBUG_LOGS env var support for debug logging in logToDashboard(). Added conditional debug messages for: no registeredSessionId, failed forwarding, error cases. 14 existing log forwarding tests pass.",
      "assignee": null,
      "created": "2026-01-04T20:30:00.000Z",
      "updated": "2026-01-04T20:45:00.000Z",
      "parentTaskId": null,
      "childTaskIds": [],
      "auditSource": "Dashboard Investigation - Session 89"
    },
    "auto-delegation-phase5-dashboard": {
      "parentTaskId": "auto-delegation-integration",
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 1,
      "id": "auto-delegation-phase5-dashboard",
      "title": "Phase 5: Dashboard Integration",
      "description": "Provide visibility into delegation activity. Add SSE events, delegation panel, history endpoint, settings UI, real-time progress.",
      "phase": "implementation",
      "priority": "medium",
      "estimate": "4h",
      "tags": [
        "auto-delegation",
        "dashboard",
        "ui"
      ],
      "depends": {
        "blocks": [
          "auto-delegation-phase6-polish"
        ],
        "requires": [
          "auto-delegation-phase4-execution",
          "fix-direct-skill-state-check"
        ],
        "related": [
          "add-hierarchy-delegation-tracking"
        ]
      },
      "acceptance": [
        "Dashboard shows active delegations",
        "Progress updates in real-time",
        "Settings can be changed from dashboard",
        "History shows past delegations"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2026-01-02T08:20:00.000Z",
      "updated": "2026-01-04T19:55:00.000Z",
      "started": "2026-01-04T03:56:30.090Z",
      "completedAt": "2026-01-04T19:55:00.000Z",
      "completionNotes": "All 4 acceptance criteria verified: (1) Hierarchy panel renders activeDelegations[] with status badges, (2) WebSocket broadcasts delegation:started/completed/failed events, (3) Settings modal section with 7 controls + API endpoints, (4) /api/delegations/history endpoint + viewDelegationHistory() modal. 229 delegation tests + 417 hierarchy tests passing."
    },
    "orchestrator-dashboard-sync-fix": {
      "id": "orchestrator-dashboard-sync-fix",
      "title": "Fix Orchestrator→Dashboard State Synchronization",
      "description": "The autonomous orchestrator fails to keep the dashboard in sync with its actual state. Issues: (1) Phase transitions not sent to dashboard - orchestrator logs '[PHASE] Advancing: X → Y' but dashboard shows stale phase. (2) Task completion not reflected - Claude marks task complete but dashboard still shows it as current. (3) Quality scores not propagated - evaluatePhaseCompletion() calculates scores but they show as 0. (4) Session not deregistered on error exit - orchestrator ends with 'error @ 65.8%' but session stays active. (5) Errors silently swallowed - all catch blocks suppress errors, making debugging impossible.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "4h",
      "tags": [
        "orchestrator",
        "dashboard",
        "integration",
        "bug-fix",
        "observability"
      ],
      "depends": {
        "blocks": [],
        "requires": [],
        "related": [
          "session-registry-id-persistence",
          "orchestrator-log-forwarding"
        ]
      },
      "acceptance": [
        "updateCommandCenter() called after every phase transition with new phase",
        "Task completion triggers session update with currentTask: null",
        "Quality scores from evaluatePhaseCompletion() sent to dashboard immediately",
        "deregisterFromCommandCenter() called in ALL exit paths (success, error, signal)",
        "Error logging added to all catch blocks (not just silent swallow)",
        "Phase history populated in session record",
        "Dashboard reflects orchestrator state within 1 second of change"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2026-01-04T20:15:00.000Z",
      "updated": "2026-01-05T00:16:00.000Z",
      "completedAt": "2026-01-05T00:16:00.000Z",
      "completionNotes": "Fixed 5 sync issues: (1) advancePhase() now calls updateCommandCenter() with phase/qualityScore/phaseHistory. (2) handleTaskCompletion() updates dashboard with currentTask:null. (3) Quality scores sent immediately after phase evaluation. (4) deregisterFromCommandCenter() awaited in gracefulShutdown() and main().catch(). (5) Error logging added to all catch blocks. Created 20 new tests in orchestrator-dashboard-sync.test.js covering unit tests, integration tests, and lifecycle test.",
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "testingGap": {
        "problem": "These integration issues are not caught by tests because:",
        "gaps": [
          "updateCommandCenter() has ZERO unit tests - function never tested",
          "recordTaskCompletionToCommandCenter() has ZERO tests",
          "deregisterFromCommandCenter() has ZERO tests",
          "E2E tests (orchestrator-dashboard.e2e.test.js) only test API endpoints work, not that orchestrator calls them",
          "E2E tests skip if server not running - not true integration tests",
          "No tests verify orchestrator lifecycle calls dashboard at right times",
          "No tests for error scenarios (dashboard down, network timeout)",
          "No tests verify phase transitions trigger updates"
        ],
        "requiredTests": [
          "Unit tests for updateCommandCenter() with mocked postToDashboard",
          "Unit tests for recordTaskCompletionToCommandCenter()",
          "Unit tests for deregisterFromCommandCenter()",
          "Integration test: orchestrator phase transition → dashboard update received",
          "Integration test: orchestrator task complete → dashboard shows null currentTask",
          "Integration test: orchestrator error exit → session deregistered",
          "Integration test: dashboard offline → errors logged, orchestrator continues",
          "Lifecycle test: full orchestrator run verifies all dashboard calls made"
        ]
      }
    },
    "otlp-claude-code-integration": {
      "id": "otlp-claude-code-integration",
      "title": "Integrate OTLP Telemetry with Claude Code CLI",
      "description": "Configure Claude Code CLI to send telemetry metrics to the dashboard's OTLP receiver. Currently the ...",
      "phase": "implementation",
      "status": "completed",
      "completedAt": "2025-12-31T00:18:00.000Z",
      "completionNotes": "Fixed OTLP receiver initialization (usageTracker optional), configured Claude Code settings with env vars, tested metrics flow end-to-end, documented in DASHBOARD-FEATURES.md"
    },
    "auto-delegation-phase6-polish": {
      "id": "auto-delegation-phase6-polish",
      "title": "Phase 6: Polish and Documentation",
      "description": "Production-ready implementation. Comprehensive error handling, graceful degradation, telemetry, user documentation, performance optimization.",
      "phase": "implementation",
      "priority": "medium",
      "estimate": "2h",
      "tags": [
        "auto-delegation",
        "documentation",
        "polish"
      ],
      "depends": {
        "blocks": [],
        "requires": [
          "auto-delegation-phase5-dashboard"
        ],
        "related": []
      },
      "acceptance": [
        "Hook failures don't break Claude Code",
        "Errors are logged with context",
        "Documentation is complete",
        "Performance meets targets (<200ms hook)"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2026-01-02T08:20:00.000Z",
      "updated": "2026-01-05T02:10:00.000Z",
      "completedAt": "2026-01-05T02:10:00.000Z",
      "completionNotes": "All acceptance criteria met. Hook gracefully handles failures, errors logged with context, CLAUDE.md updated with auto-delegation rules, hook executes in 51-85ms (<200ms target). 200+ delegation tests passing.",
      "parentTaskId": "auto-delegation-integration",
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 1,
      "started": "2026-01-04T22:45:31.421Z"
    },
    "auto-delegation-integration": {
      "id": "auto-delegation-integration",
      "title": "Auto-Delegation Integration - Connect Prompts to DelegationDecider",
      "description": "Bridge the gap between user prompts and the existing DelegationDecider/hierarchy system.",
      "phase": "implementation",
      "priority": "high",
      "estimate": "20h",
      "tags": [
        "auto-delegation",
        "hooks",
        "integration",
        "orchestration",
        "feature"
      ],
      "depends": {
        "blocks": [],
        "requires": [],
        "related": []
      },
      "acceptance": [
        "Hook runs on every prompt and injects delegation analysis",
        "DelegationDecider accurately identifies complex tasks",
        "User can force/prevent delegation with /delegate and /direct skills",
        "Dashboard shows delegation activity and progress",
        "All tests pass (160+ new tests)",
        "Documentation complete",
        "Performance targets met (< 200ms hook, < 500ms decision)"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2025-12-29T16:00:00.000Z",
      "updated": "2026-01-05T02:10:00.000Z",
      "completedAt": "2026-01-05T02:10:00.000Z",
      "completionNotes": "All 8 child phases complete. Hook injects [Delegation Analysis] on every prompt. DelegationDecider + TaskDecomposer identify complex tasks. /delegate, /direct, /delegation-status, /delegation-config skills available. Dashboard shows hierarchy and delegations. 200+ new tests, 2700+ total passing. CLAUDE.md documents auto-delegation rules. Hook: 51-85ms, Decision: <100ms.",
      "started": "2026-01-02T08:14:39.461Z",
      "parentTaskId": null,
      "childTaskIds": [
        "auto-delegation-phase1-hook",
        "auto-delegation-phase2-decision",
        "auto-delegation-phase3-skills",
        "auto-delegation-phase4-execution",
        "fix-direct-skill-state-check",
        "add-hierarchy-delegation-tracking",
        "auto-delegation-phase5-dashboard",
        "auto-delegation-phase6-polish"
      ],
      "delegatedTo": null,
      "delegationDepth": 0,
      "decomposition": "sequential"
    },
    "session-registry-id-persistence": {
      "id": "session-registry-id-persistence",
      "title": "Persist Session Registry nextId to Prevent ID Collisions",
      "description": "SessionRegistry.nextId resets to 1 when dashboard restarts, causing ID collisions with stale UI data. When old session s1 wasn't deregistered and dashboard restarts, new sessions get ID 1 again, conflicting with cached UI state. Persist nextId to memory.db so IDs are globally unique across restarts.",
      "phase": "implementation",
      "priority": "medium",
      "estimate": "1h",
      "tags": [
        "dashboard",
        "session-registry",
        "persistence",
        "bug-fix"
      ],
      "depends": {
        "blocks": [],
        "requires": [],
        "related": [
          "session-end-hook-reliability",
          "dashboard-stale-session-handling"
        ]
      },
      "acceptance": [
        "nextId persisted to memory.db on each increment",
        "nextId loaded from memory.db on dashboard startup",
        "Session IDs never reused across dashboard restarts",
        "Graceful fallback if memory.db unavailable",
        "Tests verify ID persistence across simulated restarts"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2026-01-04T20:10:00.000Z",
      "updated": "2026-01-05T04:48:00.000Z",
      "completedAt": "2026-01-05T04:48:00.000Z",
      "completionNotes": "Already fully implemented with comprehensive test coverage. SessionRegistry persists nextId to memory.db using better-sqlite3. Features: _persistNextId() with UPSERT on each register(), _loadNextIdFromDb() on startup, enhanced fallback with FallbackReason enum, auto-recovery with exponential backoff, health checks. 121 tests passing including simulated restart scenarios.",
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "started": "2026-01-05T02:53:06.464Z"
    },
    "orchestrator-phase-transition-task-loss": {
      "id": "orchestrator-phase-transition-task-loss",
      "title": "Fix Orchestrator Losing Task During Phase Transitions",
      "description": "When a task completes a phase (e.g., implement) and should transition to the next phase (e.g., test), the orchestrator loses track of the task and tries to re-claim it. Since the task is still marked as claimed/in_progress, the claim fails with 'No available tasks after 3 attempts'. The orchestrator then skips the test phase entirely and advances to complete with score 0. Root cause: state.continueWithCurrentTask is set but the task claim check runs anyway, or the claim has expired between phases. Fix should ensure task continuity across phase transitions without re-claiming.",
      "phase": "implementation",
      "priority": "critical",
      "estimate": "2h",
      "tags": [
        "orchestrator",
        "bug-fix",
        "phase-transitions",
        "task-claims",
        "critical"
      ],
      "depends": {
        "blocks": [],
        "requires": [],
        "related": [
          "session-registry-id-persistence"
        ]
      },
      "acceptance": [
        "Task persists across phase transitions (implement → test → complete)",
        "No re-claim attempt when state.continueWithCurrentTask is true",
        "Test phase actually spawns Claude session to run tests",
        "Quality scores written for each phase before advancing",
        "Claim heartbeat extended during phase transitions",
        "Graceful handling if claim expires mid-task (re-claim same task)",
        "Log clearly shows phase transition with same task ID",
        "Tests verify multi-phase task completion works end-to-end"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2026-01-05T04:00:00.000Z",
      "updated": "2026-01-05T04:44:00.000Z",
      "completedAt": "2026-01-05T04:44:00.000Z",
      "completionNotes": "Fixed claim extension during phase transitions. Added claimSpecificTask() to TaskManager. Orchestrator now extends claim before continuing to next phase, re-claims if expired. Fixed extendClaim() to use correct result.success check. 11 new tests added, 2873 total passing.",
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0,
      "bugReport": {
        "observedBehavior": "Orchestrator completes implement phase via delegation (5 parallel subtasks), then in test phase fails to claim task ('No available tasks'), skips test entirely, advances to complete with score 0",
        "expectedBehavior": "Orchestrator should continue with same task into test phase, spawn Claude session to run npm test, write quality-scores.json for test phase, then advance to complete only if score >= 90",
        "logSnippet": "[EVALUATION] Phase: test, Score: 0\\n[ITERATE] Task done but quality 0 below threshold.\\n[REASON] No scores found for current phase\\n[TASK] No task claimed: No available tasks after 3 attempts",
        "rootCause": "When phase transitions from implement to test, orchestrator loses task context and tries to re-claim instead of continuing with state.continueWithCurrentTask",
        "resolution": "Added claim extension/re-claim logic in phase transition code. Task now maintains valid claim across phases."
      },
      "started": "2026-01-05T04:40:35.444Z"
    },
    "dashboard-stale-session-handling": {
      "id": "dashboard-stale-session-handling",
      "title": "Handle Stale Session Data in Dashboard UI",
      "description": "Dashboard UI can show stale session data when session IDs are reused after dashboard restart. Old session s1 data persists in UI cache while new s1 registers with different data. UI should detect ID conflicts, clear stale data on SSE reconnect, and provide manual 'clear stale sessions' button.",
      "phase": "implementation",
      "priority": "low",
      "estimate": "1h",
      "tags": [
        "dashboard",
        "ui",
        "cache",
        "bug-fix"
      ],
      "depends": {
        "blocks": [],
        "requires": [],
        "related": [
          "session-registry-id-persistence",
          "session-end-hook-reliability"
        ]
      },
      "acceptance": [
        "UI clears session cache on SSE reconnect",
        "Add 'Clear Stale Sessions' button to dashboard",
        "Detect session ID conflicts (same ID, different claudeSessionId)",
        "Visual indicator for potentially stale sessions",
        "Auto-refresh session list on dashboard load"
      ],
      "status": "completed",
      "assignee": null,
      "created": "2026-01-04T20:10:00.000Z",
      "updated": "2026-01-05T05:16:00.000Z",
      "completedAt": "2026-01-05T05:16:00.000Z",
      "completionNotes": "Orchestrator delegated to 5 parallel agents: (1) SSE reconnect clears session cache + calls fetchSessions(), (2) Clear Stale button + POST /api/sessions/clear-stale API, (3) sessionIdHistory Map + detectSessionConflict() + toast alerts, (4) getSessionStaleness() + CSS for stale/warning states, (5) 30s interval + visibility change handler. E2E tests added.",
      "parentTaskId": null,
      "childTaskIds": [],
      "delegatedTo": null,
      "delegationDepth": 0
    },
    "cli-session-activity-logs": {
      "id": "cli-session-activity-logs",
      "title": "CLI Session Activity Logs in Dashboard",
      "description": "Display tool calls, file edits, and commands for CLI sessions in the dashboard Logs tab. Research co...",
      "phase": "implementation",
      "status": "completed",
      "completedAt": "2026-01-02T08:00:00.000Z",
      "completionNotes": "Implemented all 4 phases: API endpoint, dashboard UI update, SSE streaming, E2E tests. 9 new tests added.",
      "childTaskIds": [],
      "parentTaskId": null
    }
  },
  "lastArchived": "2026-01-07T06:13:18.277Z"
}